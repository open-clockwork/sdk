{
  "address": "5mWnTLUXiCtNbyTrniAEoPwuXVzQPM7VYr8yYaMaNhf2",
  "metadata": {
    "name": "thread_program",
    "version": "2.0.20",
    "spec": "0.1.0",
    "description": "Clockwork thread program",
    "repository": "https://github.com/clockwork-xyz/clockwork"
  },
  "docs": [
    "Program for creating transaction threads on Solana."
  ],
  "instructions": [
    {
      "name": "get_crate_info",
      "docs": [
        "Return the crate information via `sol_set_return_data/sol_get_return_data`"
      ],
      "discriminator": [
        59,
        15,
        145,
        204,
        119,
        170,
        30,
        158
      ],
      "accounts": [
        {
          "name": "system_program"
        }
      ],
      "args": [],
      "returns": {
        "defined": {
          "name": "CrateInfo"
        }
      }
    },
    {
      "name": "thread_create",
      "docs": [
        "Creates a new transaction thread."
      ],
      "discriminator": [
        54,
        1,
        238,
        224,
        71,
        244,
        252,
        173
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "signer": true
        },
        {
          "name": "payer",
          "docs": [
            "The payer for account initializations."
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "system_program",
          "docs": [
            "The Solana system program."
          ]
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be created."
          ],
          "writable": true
        }
      ],
      "args": [
        {
          "name": "amount",
          "type": "u64"
        },
        {
          "name": "id",
          "type": "bytes"
        },
        {
          "name": "instructions",
          "type": {
            "vec": {
              "defined": {
                "name": "SerializableInstruction"
              }
            }
          }
        },
        {
          "name": "trigger",
          "type": {
            "defined": {
              "name": "Trigger"
            }
          }
        }
      ]
    },
    {
      "name": "thread_delete",
      "docs": [
        "Closes an existing thread account and returns the lamports to the owner."
      ],
      "discriminator": [
        146,
        6,
        95,
        17,
        35,
        98,
        44,
        140
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "signer": true
        },
        {
          "name": "close_to",
          "docs": [
            "The address to return the data rent lamports to."
          ],
          "writable": true
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be delete."
          ],
          "writable": true
        }
      ],
      "args": []
    },
    {
      "name": "thread_exec",
      "docs": [
        "Executes the next instruction on thread."
      ],
      "discriminator": [
        141,
        79,
        219,
        140,
        125,
        246,
        162,
        160
      ],
      "accounts": [
        {
          "name": "fee",
          "docs": [
            "The worker's fee account."
          ],
          "writable": true
        },
        {
          "name": "pool",
          "docs": [
            "The active worker pool."
          ]
        },
        {
          "name": "signatory",
          "docs": [
            "The signatory."
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "thread",
          "docs": [
            "The thread to execute."
          ],
          "writable": true
        },
        {
          "name": "worker",
          "docs": [
            "The worker."
          ]
        }
      ],
      "args": []
    },
    {
      "name": "thread_instruction_add",
      "docs": [
        "Appends a new instruction to the thread's instruction set."
      ],
      "discriminator": [
        105,
        117,
        243,
        157,
        61,
        226,
        87,
        201
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "system_program",
          "docs": [
            "The Solana system program"
          ]
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be paused."
          ],
          "writable": true
        }
      ],
      "args": [
        {
          "name": "instruction",
          "type": {
            "defined": {
              "name": "SerializableInstruction"
            }
          }
        }
      ]
    },
    {
      "name": "thread_instruction_remove",
      "docs": [
        "Removes an instruction to the thread's instruction set at the provied index."
      ],
      "discriminator": [
        87,
        114,
        175,
        98,
        217,
        155,
        188,
        31
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "signer": true
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be edited."
          ],
          "writable": true
        }
      ],
      "args": [
        {
          "name": "index",
          "type": "u64"
        }
      ]
    },
    {
      "name": "thread_kickoff",
      "docs": [
        "Kicks off a thread if its trigger condition is active."
      ],
      "discriminator": [
        34,
        80,
        5,
        128,
        197,
        187,
        14,
        20
      ],
      "accounts": [
        {
          "name": "signatory",
          "docs": [
            "The signatory."
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "thread",
          "docs": [
            "The thread to kickoff."
          ],
          "writable": true
        },
        {
          "name": "worker",
          "docs": [
            "The worker."
          ]
        }
      ],
      "args": []
    },
    {
      "name": "thread_pause",
      "docs": [
        "Pauses an active thread."
      ],
      "discriminator": [
        197,
        134,
        59,
        33,
        129,
        130,
        102,
        246
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "signer": true
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be paused."
          ],
          "writable": true
        }
      ],
      "args": []
    },
    {
      "name": "thread_reset",
      "docs": [
        "Resets a thread's next instruction."
      ],
      "discriminator": [
        187,
        185,
        155,
        37,
        161,
        74,
        117,
        0
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "signer": true
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be paused."
          ],
          "writable": true
        }
      ],
      "args": []
    },
    {
      "name": "thread_resume",
      "docs": [
        "Resumes a paused thread."
      ],
      "discriminator": [
        142,
        165,
        20,
        133,
        151,
        201,
        32,
        183
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "signer": true
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be resumed."
          ],
          "writable": true
        }
      ],
      "args": []
    },
    {
      "name": "thread_update",
      "docs": [
        "Allows an owner to update the mutable properties of a thread."
      ],
      "discriminator": [
        62,
        117,
        199,
        78,
        253,
        104,
        20,
        52
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "system_program",
          "docs": [
            "The Solana system program"
          ]
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be updated."
          ],
          "writable": true
        }
      ],
      "args": [
        {
          "name": "settings",
          "type": {
            "defined": {
              "name": "ThreadSettings"
            }
          }
        }
      ]
    },
    {
      "name": "thread_withdraw",
      "docs": [
        "Allows an owner to withdraw from a thread's lamport balance."
      ],
      "discriminator": [
        210,
        190,
        114,
        194,
        186,
        179,
        184,
        176
      ],
      "accounts": [
        {
          "name": "authority",
          "docs": [
            "The authority (owner) of the thread."
          ],
          "signer": true
        },
        {
          "name": "pay_to",
          "docs": [
            "The account to withdraw lamports to."
          ],
          "writable": true
        },
        {
          "name": "thread",
          "docs": [
            "The thread to be."
          ],
          "writable": true
        }
      ],
      "args": [
        {
          "name": "amount",
          "type": "u64"
        }
      ]
    }
  ],
  "accounts": [
    {
      "name": "Fee",
      "discriminator": [
        24,
        55,
        150,
        250,
        168,
        27,
        101,
        178
      ]
    },
    {
      "name": "Pool",
      "discriminator": [
        241,
        154,
        109,
        4,
        17,
        177,
        109,
        188
      ]
    },
    {
      "name": "Thread",
      "discriminator": [
        186,
        27,
        154,
        111,
        51,
        36,
        159,
        90
      ]
    },
    {
      "name": "Worker",
      "discriminator": [
        224,
        158,
        97,
        5,
        224,
        241,
        67,
        146
      ]
    }
  ],
  "errors": [
    {
      "code": 6000,
      "name": "InvalidThreadResponse",
      "msg": "The exec response could not be parsed"
    },
    {
      "code": 6001,
      "name": "InvalidThreadState",
      "msg": "The thread is in an invalid state"
    },
    {
      "code": 6002,
      "name": "InvalidTriggerVariant",
      "msg": "The trigger variant cannot be changed"
    },
    {
      "code": 6003,
      "name": "TriggerConditionFailed",
      "msg": "The trigger condition has not been activated"
    },
    {
      "code": 6004,
      "name": "ThreadBusy",
      "msg": "This operation cannot be processes because the thread is currently busy"
    },
    {
      "code": 6005,
      "name": "ThreadPaused",
      "msg": "The thread is currently paused"
    },
    {
      "code": 6006,
      "name": "RateLimitExeceeded",
      "msg": "The thread's rate limit has been reached"
    },
    {
      "code": 6007,
      "name": "MaxRateLimitExceeded",
      "msg": "Thread rate limits cannot exceed the maximum allowed value"
    },
    {
      "code": 6008,
      "name": "UnauthorizedWrite",
      "msg": "Inner instruction attempted to write to an unauthorized address"
    },
    {
      "code": 6009,
      "name": "WithdrawalTooLarge",
      "msg": "Withdrawing this amount would leave the thread with less than the minimum required SOL for rent exemption"
    }
  ],
  "types": [
    {
      "name": "ClockData",
      "docs": [
        "The clock object, representing a specific moment in time recorded by a Solana cluster."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "slot",
            "docs": [
              "The current slot."
            ],
            "type": "u64"
          },
          {
            "name": "epoch",
            "docs": [
              "The bank epoch."
            ],
            "type": "u64"
          },
          {
            "name": "unix_timestamp",
            "docs": [
              "The current unix timestamp."
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "CrateInfo",
      "docs": [
        "Crate build information"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "spec",
            "docs": [
              "The link to the crate spec"
            ],
            "type": "string"
          },
          {
            "name": "blob",
            "docs": [
              "Arbitrary blob that can be set by developers"
            ],
            "type": "string"
          }
        ]
      }
    },
    {
      "name": "Equality",
      "docs": [
        "Operators for describing how to compare two values to one another."
      ],
      "repr": {
        "kind": "rust"
      },
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "GreaterThanOrEqual"
          },
          {
            "name": "LessThanOrEqual"
          }
        ]
      }
    },
    {
      "name": "ExecContext",
      "docs": [
        "The execution context of a particular transaction thread."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "exec_index",
            "docs": [
              "Index of the next instruction to be executed."
            ],
            "type": "u64"
          },
          {
            "name": "execs_since_reimbursement",
            "docs": [
              "Number of execs since the last tx reimbursement.",
              "To be deprecated in v3 since we now reimburse for every transaction."
            ],
            "type": "u64"
          },
          {
            "name": "execs_since_slot",
            "docs": [
              "Number of execs in this slot."
            ],
            "type": "u64"
          },
          {
            "name": "last_exec_at",
            "docs": [
              "Slot of the last exec"
            ],
            "type": "u64"
          },
          {
            "name": "trigger_context",
            "docs": [
              "Context for the triggering condition"
            ],
            "type": {
              "defined": {
                "name": "TriggerContext"
              }
            }
          }
        ]
      }
    },
    {
      "name": "Fee",
      "docs": [
        "Escrows the lamport balance owed to a particular worker."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "distributable_balance",
            "docs": [
              "The number of lamports that are distributable for this epoch period."
            ],
            "type": "u64"
          },
          {
            "name": "worker",
            "docs": [
              "The worker who received the fees."
            ],
            "type": "pubkey"
          }
        ]
      }
    },
    {
      "name": "Pool",
      "docs": [
        "* Pool"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "id",
            "type": "u64"
          },
          {
            "name": "size",
            "type": "u32"
          },
          {
            "name": "workers",
            "type": {
              "vec": "pubkey"
            }
          }
        ]
      }
    },
    {
      "name": "SerializableAccount",
      "docs": [
        "Account metadata needed to execute an instruction on Solana."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "pubkey",
            "docs": [
              "An account's public key"
            ],
            "type": "pubkey"
          },
          {
            "name": "is_signer",
            "docs": [
              "True if an Instruction requires a Transaction signature matching `pubkey`."
            ],
            "type": "bool"
          },
          {
            "name": "is_writable",
            "docs": [
              "True if the `pubkey` can be loaded as a read-write account."
            ],
            "type": "bool"
          }
        ]
      }
    },
    {
      "name": "SerializableInstruction",
      "docs": [
        "The data needed execute an instruction on Solana."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "program_id",
            "docs": [
              "Pubkey of the instruction processor that executes this instruction"
            ],
            "type": "pubkey"
          },
          {
            "name": "accounts",
            "docs": [
              "Metadata for what accounts should be passed to the instruction processor"
            ],
            "type": {
              "vec": {
                "defined": {
                  "name": "SerializableAccount"
                }
              }
            }
          },
          {
            "name": "data",
            "docs": [
              "Opaque data passed to the instruction processor"
            ],
            "type": "bytes"
          }
        ]
      }
    },
    {
      "name": "Thread",
      "docs": [
        "Tracks the current state of a transaction thread on Solana."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "authority",
            "docs": [
              "The owner of this thread."
            ],
            "type": "pubkey"
          },
          {
            "name": "bump",
            "docs": [
              "The bump, used for PDA validation."
            ],
            "type": "u8"
          },
          {
            "name": "created_at",
            "docs": [
              "The cluster clock at the moment the thread was created."
            ],
            "type": {
              "defined": {
                "name": "ClockData"
              }
            }
          },
          {
            "name": "exec_context",
            "docs": [
              "The context of the thread's current execution state."
            ],
            "type": {
              "option": {
                "defined": {
                  "name": "ExecContext"
                }
              }
            }
          },
          {
            "name": "fee",
            "docs": [
              "The number of lamports to payout to workers per execution."
            ],
            "type": "u64"
          },
          {
            "name": "id",
            "docs": [
              "The id of the thread, given by the authority."
            ],
            "type": "bytes"
          },
          {
            "name": "instructions",
            "docs": [
              "The instructions to be executed."
            ],
            "type": {
              "vec": {
                "defined": {
                  "name": "SerializableInstruction"
                }
              }
            }
          },
          {
            "name": "name",
            "docs": [
              "The name of the thread."
            ],
            "type": "string"
          },
          {
            "name": "next_instruction",
            "docs": [
              "The next instruction to be executed."
            ],
            "type": {
              "option": {
                "defined": {
                  "name": "SerializableInstruction"
                }
              }
            }
          },
          {
            "name": "paused",
            "docs": [
              "Whether or not the thread is currently paused."
            ],
            "type": "bool"
          },
          {
            "name": "rate_limit",
            "docs": [
              "The maximum number of execs allowed per slot."
            ],
            "type": "u64"
          },
          {
            "name": "trigger",
            "docs": [
              "The triggering event to kickoff a thread."
            ],
            "type": {
              "defined": {
                "name": "Trigger"
              }
            }
          }
        ]
      }
    },
    {
      "name": "ThreadSettings",
      "docs": [
        "The properties of threads which are updatable."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "fee",
            "type": {
              "option": "u64"
            }
          },
          {
            "name": "instructions",
            "type": {
              "option": {
                "vec": {
                  "defined": {
                    "name": "SerializableInstruction"
                  }
                }
              }
            }
          },
          {
            "name": "name",
            "type": {
              "option": "string"
            }
          },
          {
            "name": "rate_limit",
            "type": {
              "option": "u64"
            }
          },
          {
            "name": "trigger",
            "type": {
              "option": {
                "defined": {
                  "name": "Trigger"
                }
              }
            }
          }
        ]
      }
    },
    {
      "name": "Trigger",
      "docs": [
        "The triggering conditions of a thread."
      ],
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "Account",
            "fields": [
              {
                "name": "address",
                "docs": [
                  "The address of the account to monitor."
                ],
                "type": "pubkey"
              },
              {
                "name": "offset",
                "docs": [
                  "The byte offset of the account data to monitor."
                ],
                "type": "u64"
              },
              {
                "name": "size",
                "docs": [
                  "The size of the byte slice to monitor (must be less than 1kb)"
                ],
                "type": "u64"
              }
            ]
          },
          {
            "name": "Cron",
            "fields": [
              {
                "name": "schedule",
                "docs": [
                  "The schedule in cron syntax. Value must be parsable by the `clockwork_cron` package."
                ],
                "type": "string"
              },
              {
                "name": "skippable",
                "docs": [
                  "Boolean value indicating whether triggering moments may be skipped if they are missed (e.g. due to network downtime).",
                  "If false, any \"missed\" triggering moments will simply be executed as soon as the network comes back online."
                ],
                "type": "bool"
              }
            ]
          },
          {
            "name": "Now"
          },
          {
            "name": "Slot",
            "fields": [
              {
                "name": "slot",
                "type": "u64"
              }
            ]
          },
          {
            "name": "Epoch",
            "fields": [
              {
                "name": "epoch",
                "type": "u64"
              }
            ]
          },
          {
            "name": "Timestamp",
            "fields": [
              {
                "name": "unix_ts",
                "type": "i64"
              }
            ]
          },
          {
            "name": "Pyth",
            "fields": [
              {
                "name": "price_feed",
                "docs": [
                  "The address of the price feed to monitor."
                ],
                "type": "pubkey"
              },
              {
                "name": "equality",
                "docs": [
                  "The equality operator (gte or lte) used to compare prices."
                ],
                "type": {
                  "defined": {
                    "name": "Equality"
                  }
                }
              },
              {
                "name": "limit",
                "docs": [
                  "The limit price to compare the Pyth feed to."
                ],
                "type": "i64"
              }
            ]
          }
        ]
      }
    },
    {
      "name": "TriggerContext",
      "docs": [
        "The event which allowed a particular transaction thread to be triggered."
      ],
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "Account",
            "fields": [
              {
                "name": "data_hash",
                "docs": [
                  "The account's data hash."
                ],
                "type": "u64"
              }
            ]
          },
          {
            "name": "Cron",
            "fields": [
              {
                "name": "started_at",
                "docs": [
                  "The threshold moment the schedule was waiting for."
                ],
                "type": "i64"
              }
            ]
          },
          {
            "name": "Now"
          },
          {
            "name": "Slot",
            "fields": [
              {
                "name": "started_at",
                "docs": [
                  "The threshold slot the schedule was waiting for."
                ],
                "type": "u64"
              }
            ]
          },
          {
            "name": "Epoch",
            "fields": [
              {
                "name": "started_at",
                "docs": [
                  "The threshold epoch the schedule was waiting for."
                ],
                "type": "u64"
              }
            ]
          },
          {
            "name": "Timestamp",
            "fields": [
              {
                "name": "started_at",
                "docs": [
                  "The threshold moment the schedule was waiting for."
                ],
                "type": "i64"
              }
            ]
          },
          {
            "name": "Pyth",
            "fields": [
              {
                "name": "price",
                "type": "i64"
              }
            ]
          }
        ]
      }
    },
    {
      "name": "Worker",
      "docs": [
        "Worker"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "authority",
            "docs": [
              "The worker's authority (owner)."
            ],
            "type": "pubkey"
          },
          {
            "name": "commission_balance",
            "docs": [
              "The number of lamports claimable by the authority as commission for running the worker."
            ],
            "type": "u64"
          },
          {
            "name": "commission_rate",
            "docs": [
              "Integer between 0 and 100 determining the percentage of fees worker will keep as commission."
            ],
            "type": "u64"
          },
          {
            "name": "id",
            "docs": [
              "The worker's id."
            ],
            "type": "u64"
          },
          {
            "name": "signatory",
            "docs": [
              "The worker's signatory address (used to sign txs)."
            ],
            "type": "pubkey"
          },
          {
            "name": "total_delegations",
            "docs": [
              "The number delegations allocated to this worker."
            ],
            "type": "u64"
          }
        ]
      }
    }
  ]
}
